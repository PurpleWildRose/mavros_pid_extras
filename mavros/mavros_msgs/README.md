# MAVROS 消息与服务说明文档

## 一、消息文件（.msg）

### 1. 状态监控类（获取设备/系统状态）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `ADSBVehicle.msg` | ADS-B飞行器消息 | 存储通过ADS-B（广播式自动相关监视）接收的其他飞行器信息（如位置、速度、航班号），用于避障或空域监控 |
| `BatteryStatus.msg` | 电池状态消息 | 发布飞控电池的实时状态（电压、电流、剩余电量百分比、电池循环次数），是低电量报警的核心数据来源 |
| `CellularStatus.msg` | 蜂窝网络状态消息 | 若无人机使用4G/5G模块，发布蜂窝网络连接状态（信号强度、网络类型、IP地址） |
| `CompanionProcessStatus.msg` | 伴随计算机状态消息 | 监控“伴随计算机”（如机载树莓派）的进程状态（CPU占用、内存使用、进程ID），确保机载计算模块正常运行 |
| `OnboardComputerStatus.msg` | 机载计算机状态消息 | 发布飞控关联的机载计算机硬件状态（温度、风扇转速、存储剩余空间），用于硬件健康诊断 |
| `DebugValue.msg` | 调试值消息 | 用于开发者自定义调试数据（如算法中间变量、传感器原始值），支持多类型数据（整数、浮点数、字符串） |
| `ESCInfo.msg` / `ESCInfoItem.msg` | 电调信息消息（集合/单个） | `ESCInfo` 是多个电调信息的集合，`ESCInfoItem` 是单个电调的详细参数（型号、固件版本、最大电流），用于电调硬件识别 |
| `ESCStatus.msg` / `ESCStatusItem.msg` | 电调状态消息（集合/单个） | 实时发布电调工作状态（当前转速、输出功率、温度、错误码），用于监控电机驱动健康度（如电调过热报警） |
| `ESCTelemetry.msg` / `ESCTelemetryItem.msg` | 电调遥测消息（集合/单个） | 高精度电调数据（如电机相电流、母线电压波动），用于电机控制算法优化或故障排查 |
| `EstimatorStatus.msg` | 估计器状态消息 | 发布飞控状态估计器（如EKF/UKF）的工作状态（滤波收敛性、传感器权重、误差范围），判断定位是否可靠 |
| `ExtendedState.msg` | 扩展状态消息 | 补充飞控核心状态外的扩展信息（如着陆gear状态、VTOL机型的飞行模式切换状态、是否处于避障模式） |
| `MagnetometerReporter.msg` | 磁力计报告消息 | 发布磁力计（罗盘）的校准状态、干扰程度、多磁力计数据一致性，用于判断罗盘是否受电磁干扰 |
| `RadioStatus.msg` | 遥控器状态消息 | 发布遥控器（RC）的连接质量（信号强度、丢包率、遥控器电池电压），是遥控器断连报警的关键数据 |
| `State.msg` | 飞控状态消息 | 核心状态汇总（飞行模式、解锁状态、系统错误码、MAVLink协议版本），地面站显示的“飞控状态”主要来自此消息 |
| `StatusText.msg` | 状态文本消息 | 飞控或机载系统的文本提示（如“GPS信号弱”“电池低电量”“校准成功”），用于用户交互或日志记录 |
| `SysStatus.msg` | 系统状态消息 | 飞控硬件系统的核心健康状态（传感器在线状态、CPU负载、内存使用、通信链路状态），是系统级故障诊断的核心 |
| `TimesyncStatus.msg` | 时间同步状态消息 | 发布ROS与飞控的时间同步状态（同步误差、同步频率、是否锁定），确保多传感器数据的时间戳一致性 |
| `Vibration.msg` | 振动消息 | 发布无人机机身振动数据（X/Y/Z轴振动加速度、振动频率），用于判断电机不平衡、螺旋桨损坏等问题 |


### 2. 控制指令类（发送控制目标/参数）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `ActuatorControl.msg` | 执行器控制消息 | 直接向执行器（电机、舵机）发送控制信号（如电机占空比、舵机角度），一般用于底层控制调试 |
| `AttitudeTarget.msg` | 姿态目标消息 | 发送期望姿态目标（期望滚转/俯仰/偏航角、期望姿态角速度），飞控按此目标调整机身姿态 |
| `GlobalPositionTarget.msg` | 全局位置目标消息 | 发送全局坐标系（WGS84）下的位置目标（纬度、经度、高度、期望速度），用于航点跟踪或定点飞行 |
| `LandingTarget.msg` | 着陆目标消息 | 发布着陆目标的相对位置（如视觉识别的着陆坪坐标、距离），用于自主着陆（如精确着陆到指定平台） |
| `ManualControl.msg` | 手动控制消息 | 转发遥控器的手动控制指令（如油门、滚转/俯仰/偏航杆量），支持伴飞计算机接管手动控制 |
| `MountControl.msg` | 云台控制消息 | 发送云台的控制指令（期望俯仰/滚转/偏航角度、控制模式），用于调整云台朝向（如跟踪目标） |
| `PositionTarget.msg` | 位置目标消息 | 发送局部坐标系（ENU）下的位置/速度/加速度目标，支持混合控制（如位置+速度联合控制），用于高精度轨迹跟踪 |
| `PlayTuneV2.msg` | 播放曲调消息 | 发送音频曲调指令（如蜂鸣器播放提示音、自定义旋律），用于无人机状态提示（如起飞成功、任务完成） |
| `Thrust.msg` | 推力消息 | 发送期望推力值（如整机推力百分比、单个电机推力），用于推力控制相关的算法（如垂直起降VTOL） |
| `Trajectory.msg` | 轨迹消息 | 发布预规划的轨迹点集合（包含时间戳、位置、速度、加速度），支持飞控按轨迹平滑跟踪 |


### 3. 定位导航类（获取定位/导航数据）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `Altitude.msg` | 高度消息 | 发布多源高度数据（相对地面高度、绝对海拔高度、气压高度、GPS高度），用于高度控制或地形跟随 |
| `CamIMUStamp.msg` | 相机-IMU时间戳消息 | 同步相机图像与IMU传感器的时间戳（解决硬件时间偏差），是视觉惯性里程计（VIO）的核心同步数据 |
| `GPSINPUT.msg` | GPS输入消息 | 向飞控输入外部GPS数据（如RTK-GPS的高精度定位结果），用于提升飞控定位精度 |
| `GPSRAW.msg` | GPS原始消息 | 发布GPS模块的原始数据（卫星数量、信噪比、伪距、载波相位），用于自定义GPS解算或故障分析 |
| `GPSRTK.msg` | GPS RTK消息 | 发布RTK（实时动态定位）状态（基准站信息、RTK固定解/浮点解状态、定位精度），判断高精度定位是否生效 |
| `HomePosition.msg` | Home点位置消息 | 发布无人机“Home点”的坐标（WGS84纬度/经度/高度、局部坐标系原点），是返航、航点规划的基准 |
| `NavControllerOutput.msg` | 导航控制器输出消息 | 发布飞控导航控制器的计算结果（期望航迹角、偏航误差、距离目标的水平/垂直距离），用于导航算法调试 |
| `OpticalFlowRad.msg` | 光学流雷达消息 | 发布光学流传感器的原始数据（水平/垂直流速、距离地面高度），用于无GPS环境下的定位（如室内飞行） |
| `RTKBaseline.msg` | RTK基线消息 | 发布RTK基准站与移动站之间的基线向量（X/Y/Z轴距离、基线长度），用于RTK定位精度评估 |
| `TerrainReport.msg` | 地形报告消息 | 发布飞控获取的地形高度数据（当前位置地形高度、地形数据来源、地形跟随误差），用于地形跟随飞行 |
| `VFR_HUD.msg` | 虚拟飞行仪表盘消息 | 模拟传统飞机的HUD（平视显示器）数据（空速、地速、爬升率、航向角、油门百分比），用于直观显示飞行状态 |
| `WheelOdomStamped.msg` | 轮式里程计消息 | 若无人机带轮式底盘（如地面机器人、轮式VTOL），发布轮式里程计数据（位置、速度、时间戳），用于地面移动定位 |


### 4. 硬件交互类（与传感器/外设交互）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `CameraImageCaptured.msg` | 相机图像捕获消息 | 相机完成图像拍摄后发布的通知（图像文件名、拍摄时间戳、相机ID），用于图像与飞行状态的关联（如航拍照片标注位置） |
| `CommandCode.msg` | 命令代码消息 | 定义MAVLink命令的代码枚举（如“起飞”“返航”“执行航点”对应的数值代码），用于命令解析 |
| `OverrideRCIn.msg` | 遥控器输入覆盖消息 | 用ROS指令覆盖遥控器的原始输入（如自动控制时接管遥控器油门、转向），用于半自主控制场景 |
| `RCIn.msg` | 遥控器输入消息 | 发布遥控器的原始通道数据（如每个通道的PWM值、通道数量），用于监控遥控器操作或自定义遥控逻辑 |
| `RCOut.msg` | 遥控器输出消息 | 发布飞控向执行器（电机、舵机）输出的PWM信号（每个通道的输出值），用于调试执行器控制是否正常 |
| `RTCM.msg` | RTCM消息 | 发布RTCM（无线电技术委员会）格式的差分数据（用于RTK定位），支持向GPS模块发送差分信号以提升精度 |


### 5. 日志/文件类（数据记录与文件操作）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `FileEntry.msg` | 文件条目消息 | 描述单个文件的属性（文件名、大小、修改时间、文件类型），用于机载文件列表展示 |
| `LogData.msg` | 日志数据消息 | 发布飞控日志的原始数据（日志条目ID、数据内容、时间戳），用于日志下载或实时日志分析 |
| `LogEntry.msg` | 日志条目消息 | 描述飞控日志文件的元信息（日志ID、开始时间、日志大小、日志类型），用于日志文件的索引和管理 |


### 6. 仿真/调试类（用于硬件在环仿真）

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `HilActuatorControls.msg` | HIL执行器控制消息 | 硬件在环（HIL）仿真中，向飞控发送“虚拟执行器控制信号”（模拟电机、舵机的输入），用于仿真测试 |
| `HilControls.msg` | HIL控制消息 | HIL仿真中，向飞控发送“虚拟遥控器控制信号”（模拟手动操作），用于测试飞控对遥控指令的响应 |
| `HilGPS.msg` | HIL GPS消息 | HIL仿真中，向飞控发送“虚拟GPS数据”（模拟不同GPS信号强度、定位精度），用于测试GPS相关功能 |
| `HilSensor.msg` | HIL传感器消息 | HIL仿真中，向飞控发送“虚拟传感器数据”（IMU、气压计、磁力计数据），用于测试飞控状态估计算法 |
| `HilStateQuaternion.msg` | HIL状态四元数消息 | HIL仿真中，向飞控发送“虚拟机身状态”（位置、姿态四元数、速度），用于闭环仿真测试 |


### 7. 其他辅助类

| 消息名称 | 中文名称 | 核心用途 |
|----------|----------|----------|
| `Mavlink.msg` | MAVLink消息 | MAVROS的核心桥接消息，将MAVLink原生消息（二进制格式）封装为ROS消息，用于ROS与飞控的MAVLink消息透传 |
| `Param.msg` | 参数消息 | 描述飞控参数的元信息（参数名、参数类型、参数范围），用于参数列表展示 |
| `ParamValue.msg` | 参数值消息 | 存储单个飞控参数的当前值（参数名、数值、参数类型），用于参数读取或修改后的反馈 |
| `Tunnel.msg` | 隧道消息 | 用于在MAVLink链路中传输自定义二进制数据（如第三方传感器协议、加密数据），支持扩展非标准数据传输 |
| `VehicleInfo.msg` | 飞行器信息消息 | 存储无人机的硬件信息（机型、飞控型号、固件版本、支持的功能），用于地面站识别设备类型 |
| `Waypoint.msg` | 航点消息 | 单个航点的详细参数（WGS84坐标、停留时间、航点类型、飞行速度），是航点规划的基础单元 |
| `WaypointList.msg` | 航点列表消息 | 多个航点的集合（航点总数、航点数组），用于航点批量传输（如向飞控推送整段航线） |
| `WaypointReached.msg` | 航点到达消息 | 飞控到达指定航点后发布的通知（航点序号、到达时间戳），用于任务进度监控（如“已到达第3个航点”） |


## 二、服务文件（.srv）

### 1. 命令控制类（请求执行特定操作，返回结果）

| 服务名称 | 中文名称 | 请求（Request）内容 | 响应（Response）内容 |
|----------|----------|---------------------|----------------------|
| `CommandAck.srv` | 命令确认服务 | 命令ID、命令状态（如“执行中”“已完成”） | 确认结果（是否收到命令、命令执行状态码） |
| `CommandBool.srv` | 布尔型命令服务 | 命令类型（如“解锁/上锁”“启用/禁用某项功能”）、布尔值（true=启用，false=禁用） | 执行结果（success：是否成功，result：结果码） |
| `CommandHome.srv` | Home点命令服务 | 命令类型（如“设置Home点”“重置Home点”）、Home点坐标（可选） | 执行结果（success：是否成功，result：结果码） |
| `CommandInt.srv` | 整数型命令服务 | 命令ID（如“执行航点”“改变高度”）、整数参数（如航点序号、目标高度） | 执行结果（success：是否成功，result：结果码，command_ack：命令确认状态） |
| `CommandLong.srv` | 长命令服务 | 命令ID（如“自定义命令”“设置传感器参数”）、6个整数参数+2个浮点参数（支持复杂命令） | 执行结果（success：是否成功，result：结果码，command_ack：命令确认状态） |
| `CommandTOL.srv` | 起飞/着陆命令服务 | 命令类型（起飞/着陆）、目标高度、目标位置（可选）、降落精度 | 执行结果（success：是否成功，result：结果码） |
| `CommandTriggerControl.srv` | 触发控制命令服务 | 触发类型（如“启动相机拍照”“启动日志记录”）、控制模式（开始/停止） | 执行结果（success：是否成功，result：结果码） |
| `CommandTriggerInterval.srv` | 触发间隔命令服务 | 触发类型（如“定时拍照”）、时间间隔（如每隔2秒拍一张）、触发次数 | 执行结果（success：是否成功，result：结果码） |
| `CommandVtolTransition.srv` | VTOL过渡命令服务 | 过渡模式（如“固定翼→多旋翼”“多旋翼→固定翼”）、目标高度 | 执行结果（success：是否成功，result：结果码） |
| `SetMavFrame.srv` | 设置MAV坐标系服务 | 目标坐标系类型（如“局部ENU”“全局WGS84”“机体坐标系”） | 执行结果（success：是否成功） |
| `SetMode.srv` | 设置飞行模式服务 | 目标飞行模式（如“定点模式”“航点模式”“手动模式”）、自定义模式码 | 执行结果（success：是否成功，mode_sent：是否发送成功） |


### 2. 参数管理类（读取/修改飞控参数）

| 服务名称 | 中文名称 | 请求（Request）内容 | 响应（Response）内容 |
|----------|----------|---------------------|----------------------|
| `ParamGet.srv` | 参数读取服务 | 参数名（如“WP_RADIUS”“GPS_TYPE”） | 执行结果（success：是否成功，value：参数值，param_type：参数类型） |
| `ParamPull.srv` | 参数拉取服务 | 是否强制拉取（忽略缓存） | 执行结果（success：是否成功，param_count：拉取的参数总数，params：参数列表） |
| `ParamPush.srv` | 参数推送服务 | 参数列表（参数名+参数值） | 执行结果（success：是否成功，param_count：推送的参数总数，failed_params：推送失败的参数） |
| `ParamSet.srv` | 参数修改服务 | 参数名、参数值、参数类型（可选） | 执行结果（success：是否成功，value：修改后的参数值） |


### 3. 文件操作类（管理机载文件）

| 服务名称 | 中文名称 | 请求（Request）内容 | 响应（Response）内容 |
|----------|----------|---------------------|----------------------|
| `FileChecksum.srv` | 文件校验服务 | 文件名、文件路径 | 执行结果（success：是否成功，checksum：文件校验和（如MD5）） |
| `FileClose.srv` | 文件关闭服务 | 文件句柄（打开文件时返回的ID） | 执行结果（success：是否成功，result：结果码） |
| `FileList.srv` | 文件列表服务 | 目录路径（如“/log/”） | 执行结果（success：是否成功，file_entries：文件列表（FileEntry.msg集合）） |
| `FileMakeDir.srv` | 创建目录服务 | 目录路径（如“/data/images/”） | 执行结果（success：是否成功，result：结果码） |
| `FileOpen.srv` | 文件打开服务 | 文件名、打开模式（读/写/追加） | 执行结果（success：是否成功，file_handle：文件句柄，file_size：文件大小） |
| `FileRead.srv` | 文件读取服务 | 文件句柄、读取偏移量、读取长度 | 执行结果（success：是否成功，data：读取的二进制数据，bytes_read：实际读取字节数） |
| `FileRemove.srv` | 文件删除服务 | 文件名、文件路径 | 执行结果（success：是否成功，result：结果码） |
| `FileRemoveDir.srv` | 删除目录服务 | 目录路径 | 执行结果（success：是否成功，result：结果码） |
| `FileRename.srv` | 文件重命名服务 | 原文件名、新文件名、文件路径 | 执行结果（success：是否成功，result：结果码） |
| `FileTruncate.srv` | 文件截断服务 | 文件句柄、截断后的文件大小 | 执行结果（success：是否成功，result：结果码） |
| `FileWrite.srv` | 文件写入服务 | 文件句柄、写入偏移量、写入数据（二进制） | 执行结果（success：是否成功，bytes_written：实际写入字节数） |


### 4. 日志管理类（控制飞控日志）

| 服务名称 | 中文名称 | 请求（Request）内容 | 响应（Response）内容 |
|----------|----------|---------------------|----------------------|
| `LogRequestData.srv` | 日志数据请求服务 | 日志ID、起始偏移量、请求数据长度 | 执行结果（success：是否成功，entries：日志数据（LogData.msg）） |
| `LogRequestEnd.srv` | 日志结束请求服务 | 日志ID（停止该日志的记录） | 执行结果（success：是否成功，result：结果码） |
| `LogRequestList.srv` | 日志列表请求服务 | 无（请求所有日志文件列表） | 执行结果（success：是否成功，entries：日志条目列表（LogEntry.msg集合）） |


### 5. 其他辅助类

| 服务名称 | 中文名称 | 请求（Request）内容 | 响应（Response）内容 |
|----------|----------|---------------------|----------------------|
| `MountConfigure.srv` | 云台配置服务 | 云台ID、配置参数（如最大转角、控制模式） | 执行结果（success：是否成功，result：结果码） |
| `MessageInterval.srv` | 消息间隔设置服务 | 消息ID（如“MAVLINK_MSG_ID_ATTITUDE”）、期望发布间隔（毫秒） | 执行结果（success：是否成功，interval_us：实际设置的间隔（微秒）） |
| `StreamRate.srv` | 数据流速率设置服务 | 数据流类型（如“ALL”“IMU”“GPS”）、期望速率（赫兹）、是否使能 | 执行结果（success：是否成功） |
| `VehicleInfoGet.srv` | 飞行器信息获取服务 | 无（请求所有硬件信息） | 执行结果（success：是否成功，info：飞行器信息（VehicleInfo.msg）） |
| `WaypointClear.srv` | 航点清除服务 | 无（清除所有航点） | 执行结果（success：是否成功，result：结果码） |
| `WaypointPull.srv` | 航点拉取服务 | 是否强制拉取（忽略缓存） | 执行结果（success：是否成功，waypoint_count：拉取的航点总数，waypoints：航点列表） |
| `WaypointPush.srv` | 航点推送服务 | 航点列表（Waypoint.msg集合）、是否覆盖原有航点 | 执行结果（success：是否成功，waypoint_count：推送的航点总数，failed_waypoints：推送失败的航点） |
| `WaypointSetCurrent.srv` | 设置当前航点服务 | 航点序号（如“3”表示将第3个航点设为当前目标） | 执行结果（success：是否成功，result：结果码） |
